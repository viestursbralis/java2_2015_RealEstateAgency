SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

DROP SCHEMA IF EXISTS `RealEstateAgency`;
CREATE SCHEMA IF NOT EXISTS `RealEstateAgency` DEFAULT CHARACTER SET utf8 ;
USE `RealEstateAgency` ;


DROP TABLE IF EXISTS `RealEstateAgency`.category;
CREATE TABLE IF NOT EXISTS CATEGORY (
CATEGORY_ID INT NOT NULL AUTO_INCREMENT ,
  CATEGORY_SHORT_NAME VARCHAR(20) NOT NULL,
CATEGORY_DESCRIPTION VARCHAR(100) NOT NULL ,
PRIMARY KEY (CATEGORY_ID)
);

DROP TABLE IF EXISTS `RealEstateAgency`.agent;
CREATE TABLE IF NOT EXISTS AGENT (
 AGENT_ID INT NOT NULL AUTO_INCREMENT ,
  AGENT_FIRST_NAME VARCHAR(20) NOT NULL,
  AGENT_LAST_NAME VARCHAR (20) NOT NULL,
  AGENT_STATUSS VARCHAR (20) NOT NULL,
  AGENT_BIOGRAPHY VARCHAR(200) NOT NULL ,
  AGENT_EMAIL VARCHAR (60) NOT NULL,
  AGENT_PASSWORD VARCHAR(20) NOT NULL,
  PRIMARY KEY (AGENT_ID)
);


DROP TABLE IF EXISTS `RealEstateAgency`.property;
CREATE TABLE PROPERTY (
  PROPERTY_ID INT NOT NULL AUTO_INCREMENT ,
  CATEGORY_ID INT NOT NULL ,

  USER_ID INT NOT NULL,
  PROPERTY_DESCRIPTION VARCHAR(200) NOT NULL ,
  PRICE DECIMAL (18,2) NOT NULL,
   ADRESS VARCHAR (60) NOT NULL ,
  AREA DECIMAL (18,2) NOT NULL ,
  COUNT_OF_BEDROOMS INT NOT NULL ,
  LAND_AREA DECIMAL  (18,2) ,
  PRIMARY KEY (PROPERTY_ID) ,
  FOREIGN KEY (CATEGORY_ID) REFERENCES CATEGORY(CATEGORY_ID),
  FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID)
);

DROP TABLE IF EXISTS `RealEstateAgency`.property_owner_junction;
CREATE TABLE PROPERTY_OWNER_JUNCTION(
  PROPERTY_ID INT NOT NULL ,
  PROPERTY_OWNER_ID INT NOT NULL ,
  PRIMARY KEY (PROPERTY_ID, PROPERTY_OWNER_ID) ,
  FOREIGN KEY(PROPERTY_ID) REFERENCES PROPERTY (PROPERTY_ID) ON DELETE CASCADE,
  FOREIGN KEY (PROPERTY_OWNER_ID) REFERENCES PROPERTY_OWNER (PROPERTY_OWNER_ID)

);

DROP TABLE IF EXISTS `RealEstateAgency`.property_owner;
CREATE TABLE PROPERTY_OWNER (
  PROPERTY_OWNER_ID INT NOT NULL AUTO_INCREMENT ,

  FIRST_NAME VARCHAR(20) NOT NULL ,
  LAST_NAME VARCHAR(20) NOT NULL ,
  OWNER_EMAIL VARCHAR(60) NOT NULL,
  OWNER_CODE VARCHAR (20) NOT NULL ,
  PRIMARY KEY (PROPERTY_OWNER_ID)
);


DROP TABLE IF EXISTS `RealEstateAgency`.utility;
CREATE TABLE UTILITY (
  UTILITY_ID INT NOT NULL AUTO_INCREMENT ,

  UTILITY_DESCRIPTION VARCHAR(50) NOT NULL,
  PRIMARY KEY (UTILITY_ID)

);


DROP TABLE IF EXISTS `RealEstateAgency`.property_utility_junction;
CREATE TABLE PROPERTY_UTILITY_JUNCTION (
  PROPERTY_ID INT NOT NULL,
  UTILITY_ID INT NOT NULL,
  PRIMARY KEY (PROPERTY_ID, UTILITY_ID) ,
  FOREIGN KEY(PROPERTY_ID) REFERENCES PROPERTY (PROPERTY_ID) ON DELETE CASCADE,
  FOREIGN KEY (UTILITY_ID) REFERENCES UTILITY (UTILITY_ID)

);

DROP TABLE IF EXISTS `RealEstateAgency`.users;
CREATE TABLE IF NOT EXISTS USERS (
  USER_ID INT NOT NULL AUTO_INCREMENT ,
  USER_FIRST_NAME VARCHAR(20) NOT NULL ,
  USER_LAST_NAME VARCHAR (20) NOT NULL ,
  USER_STATUSS VARCHAR (20) NOT NULL ,
  USER_EMAIL VARCHAR (60) NOT NULL ,
  USER_PASSWORD VARCHAR(20) NOT NULL ,
  AGENT_ID INT NOT NULL ,
  PRIMARY KEY (USER_ID),
  FOREIGN KEY (AGENT_ID) REFERENCES AGENT(AGENT_ID)
);
DROP TABLE IF EXISTS `RealEstateAgency`.photos;
CREATE TABLE IF NOT EXISTS PHOTOS (
  PHOTO_ID INT NOT NULL AUTO_INCREMENT ,
  PHOTO_NAME VARCHAR(100) NOT NULL ,
  PRIMARY KEY (PHOTO_ID)
);

DROP TABLE IF EXISTS `RealEstateAgency`.property_photos_junction;
CREATE TABLE PROPERTY_PHOTOS_JUNCTION (
  PROPERTY_ID INT NOT NULL,
  PHOTO_ID INT NOT NULL,
  PRIMARY KEY (PROPERTY_ID, PHOTO_ID) ,
  FOREIGN KEY(PROPERTY_ID) REFERENCES PROPERTY (PROPERTY_ID) ON DELETE CASCADE,
  FOREIGN KEY (PHOTO_ID) REFERENCES PHOTOS (PHOTO_ID)

);



INSERT INTO `agent` (`AGENT_ID`, `AGENT_FIRST_NAME`, `AGENT_LAST_NAME`, `AGENT_STATUSS`, `AGENT_BIOGRAPHY`, `AGENT_EMAIL`, `AGENT_PASSWORD`)
VALUES
  (1, 'Viesturs', 'Bralis', 'JUNIOR', 'Blablabla', 'viesturs@agency.com', 'viesturs'),
  (2, 'Dmitrijs', 'Aleksandrovs', 'SENIOR', 'Blablabla', 'dmitrijs@agency.com' , 'drimtrijs');


INSERT INTO `category` (`CATEGORY_ID`, `CATEGORY_SHORT_NAME`, `CATEGORY_DESCRIPTION`) VALUES
  (1, 'HOUSE_FOR_SALE', 'LIST of houses FOR sale'),
  (2, 'CONDO_FOR_SALE', 'LIST of Condos FOR sale'),
  (3, 'HOUSE_FOR_RENT', 'LIST of Houses FOR rent'),
  (4, 'CONDO_FOR_RENT', 'LIST of Condos FOR rent');


INSERT INTO `users` (`USER_ID`, `USER_FIRST_NAME`, `USER_LAST_NAME`, `USER_STATUSS`, `USER_EMAIL`, `USER_PASSWORD`)
VALUES
  (1, 'kaamis', 'kaamis', 'CLIENT', 'kaamis@gmail.com', 'kaamis'),
  (2, 'krabis', 'krabis', 'CLIENT', 'krabis@gmail.com', 'krabis');

INSERT INTO `utility` (`UTILITY_ID`, `UTILITY_DESCRIPTION`) VALUES
  (1, 'Broadband_internet_cable'),
  (2, 'City_gas_pipe'),
  (3, 'City_heat'),
  (4, 'City_water'),
  (5, 'City_sewer');









